"use strict";if(void 0===window.kbox){const e=function(){let e={LANDSCAPE:"LANDSCAPE",PORTRAIT:"PORTRAIT"},t={},n=!1,i="",o={},a=0,d={width:.925*window.innerWidth,height:.925*window.innerHeight,orientation:e.LANDSCAPE},l={lang:"fr",animationSpeed:500,keyboard:!0,titles:!0,afterOpening:function(e){},afterTransition:function(e){},afterClosing:function(e){}};const c=function(t){let n=1,i=d.orientation===e.PORTRAIT?.9:.8;if(t.width>d.width&&t.height>d.height){let e=parseFloat(d.width/t.width*i),o=parseFloat(d.height/t.height*i);n=e-o<=0?e:o}else t.width>d.width?n=parseFloat(d.width/t.width*i):t.height>d.height&&(n=parseFloat(d.height/t.height*i));return t.width=t.width*n.toFixed(2),t.height=t.height*n.toFixed(2),t},r=function(e){let n=b.gallery(e),i=Object.keys(o).length;void 0===o[n]?o[n]={id:i,name:n,pictures:[],occurrences:0}:o[n].occurrences++,o[n].pictures[o[n].occurrences]=function(e){let n=new Image;return n.onload=function(){c(n)},n.src=e.href,n.alt=e.firstElementChild.alt,0===n.height&&(n.src="https://via.placeholder.com/350",n.alt=t.notFound),n}(e)},s=function(e){e.preventDefault();let t=e.target,d=t.parentElement;n=!0,i=b.gallery(d),o[i].pictures.forEach((function(e,n){t.src===e.src&&(a=n)})),window.dispatchEvent(w.custom.modal.contextualized)},u=function(){let e=v.modal.getElementsByTagName("img");if(!e.length)throw new Error("Img tag not found");e[0].src=o[i].pictures[a].src,e[0].alt=o[i].pictures[a].alt,e[0].height=o[i].pictures[a].height,e[0].width=o[i].pictures[a].width,v.theme.textContent=i,v.quantities.textContent=t.position.replace(/{{current}}/i,(a+1).toString()).replace(/{{total}}/i,o[i].pictures.length.toString()),v.alt.textContent=o[i].pictures[a].alt},h=function(e){e.preventDefault(),u(),Velocity(v.overlay,{opacity:1,display:"block",duration:200}),Velocity(v.modal,{top:b.position().y,left:b.position().x,opacity:1,display:"block",duration:l.animationSpeed},(function(){window.dispatchEvent(w.custom.modal.opened)}))},p=function(e){e.preventDefault(),a=0,n=!1,i="",Velocity(v.overlay,{display:"none",opacity:0,duration:250}),Velocity(v.modal,{display:"none",opacity:0,duration:250},(function(){window.dispatchEvent(w.custom.modal.closed)}))},m=function(){Velocity(v.modal,{display:"none",opacity:0,duration:250},"spring",(function(){u(),Velocity(v.modal,{top:b.position().y,left:b.position().x,opacity:1,display:"block",duration:l.animationSpeed},"spring",(function(){}))}))},g=function(e){return new Promise((function(t,n){!function(e,t){let n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&200===n.status?t({status:200,json:n.responseText}):4===n.readyState&&200!==n.status&&t({status:n.status,json:{}})},n.send(null)}("./locales/"+e+".json",(function(e){200===e.status?t(JSON.parse(e.json)):n(JSON.parse(e.json))}))}))},f={increase:function(){a+1>o[i].pictures.length-1?a=0:a++,window.dispatchEvent(w.custom.modal.pointed)},decrease:function(){a-1<0?a=o[i].pictures.length-1:a--,window.dispatchEvent(w.custom.modal.pointed)}},b={gallery:function(e){return void 0!==e.getAttribute("data-kbox")?e.getAttribute("data-kbox"):"isolated"},position:function(){return{x:parseFloat((window.innerWidth-o[i].pictures[a].width)/2-10),y:parseFloat((window.innerHeight-o[i].pictures[a].height)/2-10)}}},w={custom:{modal:{contextualized:new Event("modal.contextualized"),pointed:new Event("modal.pointed"),opened:new Event("modal.opened"),transitioned:new Event("modal.transitioned"),closed:new Event("modal.closed"),exited:new Event("modal.exited")}},init:function(e){window.addEventListener("modal.contextualized",h),window.addEventListener("modal.pointed",m),window.addEventListener("modal.opened",l.afterOpening),window.addEventListener("modal.transitioned",l.afterTransition),window.addEventListener("modal.closed",l.afterClosing),window.addEventListener("modal.exited",p),l.keyboard&&w.keyboard(),w.opening(e),w.closing(),"ontouchstart"in document.documentElement?w.touch():w.navigation()},opening:function(e){e.forEach((function(e){e.addEventListener("click",s,!1)}))},closing:function(){let e=document.querySelectorAll(".kbox-close--trigger");if(!e.length)return!1;e.forEach((function(e){e.addEventListener("click",p,!1)}))},keyboard:function(){v.body.addEventListener("keyup",(function(e){if(e.preventDefault(),!0===n){switch(e.keyCode){case 37:case 100:f.decrease();break;case 39:case 102:f.increase();break;case 27:window.dispatchEvent(w.custom.modal.exited)}}}),!1)},navigation:function(){let e=document.querySelectorAll(".kbox-nav");if(!e.length)return!1;e.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),"kbox-nav--prev"===e.target.id?f.decrease():f.increase()}),!1)}))},touch:function(){let e=0,t=0;v.modal.addEventListener("touchstart",(function(n){n.changedTouches&&(e=n.changedTouches[0].screenX),t=n.changedTouches[0].screenY}),!1),v.modal.addEventListener("touchend",(function(t){t.changedTouches&&t.changedTouches[0].screenX+20>e+20?f.decrease():t.changedTouches&&t.changedTouches[0].screenX+20<e+20&&f.increase()}),!1)}},v={body:null,overlay:null,modal:null,image:null,theme:null,quantities:null,alt:null,init:function(){v.body.appendChild(v.build.overlay()),v.body.appendChild(v.build.modal()),v.overlay=document.getElementById("kbox-overlay"),v.modal=document.getElementById("kbox-modal"),v.image=document.getElementById("kbox-image"),v.theme=document.getElementById("kbox-info--theme"),v.alt=document.getElementById("kbox-info--alt"),v.quantities=document.getElementById("kbox-info--quantities")},build:{overlay:function(){let e=document.createElement("div");return e.setAttribute("id","kbox-overlay"),e.setAttribute("class","kbox-close--trigger"),e},navigation:function(e){let n=document.createElement("div");n.setAttribute("id",e),n.setAttribute("class","kbox-nav"),l.titles&&n.setAttribute("title","kbox-nav--prev"===e?t.previous:t.next);let i=document.createElement("span");return i.setAttribute("class","kbox-nav--prev"===e?"hc hc-arrow-round-back":"hc hc-arrow-round-forward"),n.appendChild(i),n},modal:function(){let e=document.createElement("div");e.setAttribute("id","kbox-modal");let n=document.createElement("div");n.setAttribute("id","kbox-close"),n.setAttribute("class","kbox-close--trigger"),l.titles&&n.setAttribute("title",t.close);let i=document.createElement("i");i.setAttribute("class","hc hc-close"),n.appendChild(i);let o=new Image;o.setAttribute("id","kbox-image");let a=document.createElement("div");a.setAttribute("id","kbox-info");let d=document.createElement("div");d.setAttribute("id","kbox-info--context");let c=document.createElement("span");c.setAttribute("id","kbox-info--theme");let r=document.createElement("span");r.setAttribute("id","kbox-info--quantities");let s=document.createElement("div");s.setAttribute("id","kbox-info--alt"),d.appendChild(c),d.appendChild(r),a.appendChild(d),a.appendChild(s);let u=v.build.navigation("kbox-nav--prev"),h=v.build.navigation("kbox-nav--next");return e.appendChild(u),e.appendChild(o),e.appendChild(h),e.appendChild(a),e.appendChild(n),v.modal=e,e}}},y={init:async function(n){try{if(l=Object.assign(l,n),t=await g(l.lang),window.innerWidth<window.innerHeight&&(d.orientation=e.PORTRAIT),v.body=document.getElementsByTagName("body")[0],!v.body)return!1;let i=document.querySelectorAll(".kbox"),o=i.length;if(!i.length)return!1;for(let e=0;e<=o-1;e++)l.titles&&(i[e].title=t.display),r(i[e]);v.init(),w.init(i)}catch(e){alert(e.message)}}};return y};window.kbox=e().init}else console.log("Namespace kbox already exists !");